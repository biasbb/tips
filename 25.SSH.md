那么这里一共有两组四个密钥：A的公钥（PUB_A），A的私钥（PRI_A）；B的公钥（PUB_B），B的私钥（PRI_B）。

**公钥一般用来加密，私钥用来签名。加密是为了别人看不到，签名是为了证明收到的是你发送的**

通常公钥是公开出去的，但是私钥只能自己私密持有。

公钥和私钥唯一对应，用某个公钥签名过得内容只能用对应的私钥才能解签验证；同样用某个私钥加密的内容只能用对应的公钥才能解密。

这时A向B发送信息的整个签名和加密的过程如下：
1、A先用自己的私钥（PRI_A）对信息（一般是信息的摘要）进行签名。
2、A接着使用B的公钥（PUB_B）对信息内容和签名进行加密，然后一起发送给B 。

这样当B接收到A的信息后，获取信息内容的步骤如下：
1、用自己的私钥（PRI_B）解密A用B的公钥（PUB_B）加密的内容，得到信息内容和签名；
2、得到解密后的明文后用A的公钥（PUB_A）解签A用A自己的私钥（PRI_A）的签名，如果解密得到的摘要和信息的摘要是一样的，证明是A发送的。

从而整个过程就保证了开始说的端到端的唯一确认。A的签名只有A的公钥才能解签，这样B就能确认这个信息是A发来的；A的加密只有B的私钥才能解密，这样A就能确认这份信息只能被B读取。

---

SSH 为 [Secure Shell](https://baike.baidu.com/item/Secure Shell) 的缩写，安全壳协议。由 IETF 的网络小组（Network Working Group）所制定；SSH 为建立在应用层基础上的安全协议。

SSH 是目前较可靠，专为[远程登录](https://baike.baidu.com/item/远程登录/1071998)会话和其他网络服务提供安全性的协议。

从客户端来看，SSH提供两种级别的安全验证。

- **第一种级别（基于口令的安全验证）**

  只要你知道自己帐号和口令，就可以登录到远程主机。所有传输的数据都会被加密，但是不能保证你正在连接的服务器就是你想连接的[服务器](https://baike.baidu.com/item/服务器)。可能会有别的服务器在冒充真正的服务器，也就是受到“中间人”这种方式的攻击。

- **第二种级别（基于密钥的安全验证）**需要依靠密钥，也就是你必须为自己创建一对密匙，并把公用密匙放在需要访问的服务器上。如果你要连接到SSH服务器上，客户端软件就会向服务器发出请求，请求用你的密匙进行安全验证。服务器收到请求之后，先在该服务器上你的主目录下寻找你的公用密匙，然后把它和你发送过来的公用密匙进行比较。如果两个密匙一致，服务器就用公用密匙加密“质询”（challenge）并把它发送给客户端软件。客户端软件收到“质询”之后就可以用你的私人密匙解密再把它发送给服务器。

  用这种方式，你必须知道自己密匙的[口令](https://baike.baidu.com/item/口令)。但是，与第一种级别相比，第二种级别不需要在网络上传送口令。

  第二种级别不仅加密所有传送的数据，而且“中间人”这种攻击方式也是不可能的（因为他没有你的私人密匙）。但是整个登录的过程可能需要10秒  。

  >SSH基于密钥认证的原理
  >
  >前提 
  >Ac：客户端公钥，Bc：客户端密钥，As：服务器公钥，Bs ：服务器密钥。在认证之前，客户端需要通过某种方法将公钥 Ac 登录到服务器上。 
  >认证过程分为两个步骤： 
  >1. 会话密钥(session key)生成 
  >1). 客户端请求连接服务器，服务器将 As 发送给客户端。 
  >2). 服务器生成会话ID(session id)，设为 p，发送给客户端。 
  >3). 客户端生成会话密钥(session key)，设为 q，并计算 r = p xor q。 
  >4). 客户端将 r 用 As 进行加密，结果发送给服务器。 
  >5). 服务器用 Bs 进行解密，获得 r。 
  >6). 服务器进行 r xor p 的运算，获得 q。 
  >7). 至此服务器和客户端都知道了会话密钥q，以后的传输都将被 q 加密。 
  >2. 认证 
  >1) 服务器生成随机数 x，并用 Ac 加密后生成结果 S(x)，发送给客户端 
  >2) 客户端使用 Bc 解密 S(x) 得到 x 
  >3) 客户端计算 q + x 的 md5 值 n(q+x)，q为上一步得到的会话密钥 
  >4) 服务器计算 q + x 的 md5 值 m(q+x) 
  >5) 客户端将 n(q+x) 发送给服务器 
  >6) 服务器比较 m(q+x) 和 n(q+x)，两者相同则认证成功
  
- 一般加密算法和数字摘要算法一起使用，数字摘要算法就是将任意长度的消息变成固定长度的短消息 ，如sha256，然后再用RSA加密传输